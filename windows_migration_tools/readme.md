# Windows Migration Script


## Known Issues
* OneDrive files will report access denied in the Desktop, Documents and Pictures folders. Still working on a way to exclude these files but if you see the access denied for my desktop, my documents in those folders that is why.

## Limitations
* This will not transfer bookmarks or autofill for Google Chrome as the data for that isn’t always consistent so recommend exporting them then importing them.

## Using the Script
Using the migration script is straight forward but there’s few notes to keep in mind. Follow the steps out lined below. You will need an external drive or network storage to house the migration data. For ease of use, I just have the script saved to the drive or network storage.

1. Because this script is not signed, you must make powershell able to run scripts unrestricted. While in the user’s account on the original machine, run powershell as administrator. Then **enter set-executionpolicy unrestricted** then hit **A** + enter for the next prompt. 

#### NOTE: _Keep this window open to remind you to set it back to restricted by entering set-executionpolicy restricted then hit A + enter. To check what policy is currently active simply enter get-executionpolicy_

2. Run the script by right-clicking and hit run with powershell.

3. It will ask whether the computer is the old device or new one. Enter the **old**

4.  It will ask you for the username which will be the username same as you login for the computer like, i.e. **billy.cabbage**. The script will ask where you want to store the data, typically this is to a drive which you can enter the drive letter like "D:\". Be sure to pay attention to the **False** flags indicators for your path checks. This was put in to avoid failures until I could find a way to automate this. Be sure to enter the text exactly as described in the powershell instructions with no capitalization. It should report back with

**True**
**True**

if recognizes all connections. If not, enter **no** and restart the script.

5. Once the script has run it will tell you at what stage it is processing. It will also show failures if it cannot read files that were stored in OneDrive, This is normal until I can patch them out via an exclusion. Any other failures should be looked at in the logs. The logs for copying the data from the old device will be in 
**copy_log.txt** in the transfer directory that gets generated by the script. For the new device the logs will be in the **transfer_log.txt** in the transfer directory that gets generated by the script. 


6. It will notify you when it is complete via windows pop-up message, it may appear behind the screen.

7. Simply run the script again on the new device this time entering new. You’ll need to enter the source for where the transfer file from the last step. Again, it will report True flags if all connections were successful like so

**True**
**True**

If not, or reports a false enter **no** to exit and restart the script.

8. Similarly, to the migration you ran before, it will transfer the data to the user’s account this time saying transferred. It will give you a windows pop-up message when it completes.

8. Be sure to **set-executionpolicy** back to **restricted** before you finish with the devices to maintain security.

If you want to double check any of the errors or oddities while running the script check inside the transfer directory for **copy_log.txt** for the logs when you copied for the old machine. And **transfer_log.txt** for when migrating to the new machine.

Congrats! if all goes well your user will have have their user account files, outlook signature, sticky notes AND quick access links all carried over to the new device.